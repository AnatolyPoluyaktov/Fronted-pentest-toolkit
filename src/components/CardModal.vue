<template>
 <v-dialog
      v-model="dialog"
      scrollable
      max-width="500px"
    >
      <template v-slot:activator="{ on, attrs }">
        <v-btn
          color="primary"
          dark
          v-bind="attrs"
          v-on="on"
        >
          Open Dialog
        </v-btn>
      </template>
      <v-card>
        <v-card-title>Select Country</v-card-title>
        <v-divider></v-divider>
        <v-card-text style="height: 300px;">
            <v-list-item
        v-for="(item, index) in titles"
        :key="index"
        >


          <v-list-item-content>
            <v-list-item-title>{{ item["body"] }}</v-list-item-title>
          </v-list-item-content>


        </v-list-item>



        <v-card v-intersect="infiniteScrolling">

</v-card>
        </v-card-text>
        <v-divider></v-divider>

      </v-card>
    </v-dialog>

      <!--Add here the vuetify directive -->


  </template>

  <script>
  import axios from "axios";

  export default {
    name: "Posts",
    data() {
      return {
        titles: [],
        page: 1,
        dialog: false,
      };
    },
    computed: {
      url() {
        return "https://jsonplaceholder.typicode.com/posts?_page=" + this.page;
      }
    },
    created() {
      this.fetchData();
    },
    methods: {
      async fetchData() {
        const response = await axios.get(this.url);
        this.titles = response.data;
      },
      infiniteScrolling(entries, observer, isIntersecting) {
        setTimeout(() => {
          this.page++;
          axios
            .get(this.url)
            .then(response => {
                console.log(response.data.length);
              if (response.data.length > 1) {
                response.data.forEach(item => this.titles.push(item));
              } else {
              }
            })
            .catch(err => {
              console.log(err);
            });
        }, 500);
      }
    }
  };
  </script>

  <style scoped>
  .theme--light.v-card {
    background-color: #f5f5f5;
  }
  </style>
